{
  "entityType" : "RULE_CHAIN",
  "entity" : {
    "additionalInfo" : {
      "description" : "Text via Twilio, and other types/logic to be added"
    },
    "configuration" : null,
    "debugMode" : true,
    "externalId" : null,
    "firstRuleNodeId" : {
      "entityType" : "RULE_NODE",
      "id" : "8e9882a0-3101-11eb-8887-e94257e8a11b"
    },
    "id" : {
      "entityType" : "RULE_CHAIN",
      "id" : "8e8aee10-3101-11eb-8887-e94257e8a11b"
    },
    "name" : "New Notifier",
    "root" : false,
    "type" : "CORE"
  },
  "metaData" : {
    "connections" : [ {
      "fromIndex" : 0,
      "toIndex" : 6,
      "type" : "True"
    }, {
      "fromIndex" : 1,
      "toIndex" : 8,
      "type" : "Failure"
    }, {
      "fromIndex" : 1,
      "toIndex" : 12,
      "type" : "Success"
    }, {
      "fromIndex" : 2,
      "toIndex" : 3,
      "type" : "Failure"
    }, {
      "fromIndex" : 2,
      "toIndex" : 3,
      "type" : "False"
    }, {
      "fromIndex" : 2,
      "toIndex" : 3,
      "type" : "True"
    }, {
      "fromIndex" : 2,
      "toIndex" : 8,
      "type" : "Failure"
    }, {
      "fromIndex" : 2,
      "toIndex" : 8,
      "type" : "False"
    }, {
      "fromIndex" : 2,
      "toIndex" : 13,
      "type" : "True"
    }, {
      "fromIndex" : 3,
      "toIndex" : 1,
      "type" : "True"
    }, {
      "fromIndex" : 3,
      "toIndex" : 8,
      "type" : "Failure"
    }, {
      "fromIndex" : 4,
      "toIndex" : 5,
      "type" : "Success"
    }, {
      "fromIndex" : 6,
      "toIndex" : 7,
      "type" : "Success"
    }, {
      "fromIndex" : 9,
      "toIndex" : 5,
      "type" : "Success"
    }, {
      "fromIndex" : 10,
      "toIndex" : 9,
      "type" : "False"
    }, {
      "fromIndex" : 10,
      "toIndex" : 11,
      "type" : "True"
    }, {
      "fromIndex" : 11,
      "toIndex" : 4,
      "type" : "True"
    }, {
      "fromIndex" : 12,
      "toIndex" : 10,
      "type" : "True"
    }, {
      "fromIndex" : 13,
      "toIndex" : 14,
      "type" : "True"
    }, {
      "fromIndex" : 14,
      "toIndex" : 0,
      "type" : "True"
    }, {
      "fromIndex" : 14,
      "toIndex" : 6,
      "type" : "False"
    }, {
      "fromIndex" : 15,
      "toIndex" : 2,
      "type" : "Success"
    }, {
      "fromIndex" : 15,
      "toIndex" : 23,
      "type" : "Success"
    }, {
      "fromIndex" : 15,
      "toIndex" : 24,
      "type" : "Success"
    }, {
      "fromIndex" : 15,
      "toIndex" : 25,
      "type" : "Failure"
    }, {
      "fromIndex" : 16,
      "toIndex" : 17,
      "type" : "True"
    }, {
      "fromIndex" : 17,
      "toIndex" : 18,
      "type" : "True"
    }, {
      "fromIndex" : 18,
      "toIndex" : 19,
      "type" : "True"
    }, {
      "fromIndex" : 18,
      "toIndex" : 20,
      "type" : "False"
    }, {
      "fromIndex" : 19,
      "toIndex" : 22,
      "type" : "Success"
    }, {
      "fromIndex" : 20,
      "toIndex" : 21,
      "type" : "True"
    }, {
      "fromIndex" : 21,
      "toIndex" : 22,
      "type" : "Success"
    } ],
    "firstNodeIndex" : 15,
    "nodes" : [ {
      "additionalInfo" : {
        "description" : null,
        "layoutX" : 1089,
        "layoutY" : 76
      },
      "configuration" : {
        "jsScript" : "return (msg.status == \"ACTIVE_UNACK\");"
      },
      "configurationVersion" : 0,
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "8e92b640-3101-11eb-8887-e94257e8a11b"
      },
      "name" : "Alarm Unacknowledged",
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.filter.TbJsFilterNode"
    }, {
      "additionalInfo" : {
        "description" : null,
        "layoutX" : 642,
        "layoutY" : 356
      },
      "configuration" : {
        "jsScript" : "metadata.alarmType = msg.type;\r\nmetadata.alarmSeverity = msg.severity;\r\nmetadata.originatorLabel = msg.details.originatorLabel;\r\n\r\nvar d = new Date(msg.createdTime);\r\nmetadata.alarmTime = d.toLocaleString();\r\n\r\n\r\nif (msg.clearTs !== 0){\r\n    var c = new Date(msg.clearTs); \r\n    metadata.clearTime = c.toLocaleString();\r\n}\r\n\r\nreturn {msg: msg, metadata: metadata, msgType: msgType};\r\n    "
      },
      "configurationVersion" : 0,
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "8e932b70-3101-11eb-8887-e94257e8a11b"
      },
      "name" : "Build email Notif",
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.transform.TbTransformMsgNode"
    }, {
      "additionalInfo" : {
        "description" : null,
        "layoutX" : 311,
        "layoutY" : 150
      },
      "configuration" : {
        "jsScript" : "if (msg.severity == \"MAJOR\") \n    return metadata.ss_major_text === 'true';\nelse if (msg.severity == \"CRITICAL\")\n    return metadata.ss_critical_text === 'true';\n"
      },
      "configurationVersion" : 0,
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "8e93a0a0-3101-11eb-8887-e94257e8a11b"
      },
      "name" : "Text Alert for Major/Critical Alarm",
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.filter.TbJsFilterNode"
    }, {
      "additionalInfo" : {
        "description" : null,
        "layoutX" : 373,
        "layoutY" : 357
      },
      "configuration" : {
        "jsScript" : "if (msg.severity == \"MAJOR\") \n    return metadata.ss_major_email === 'true';\nelse if (msg.severity ==\"CRITICAL\")\n    return metadata.ss_critical_email === 'true';\n"
      },
      "configurationVersion" : 0,
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "8e9415d0-3101-11eb-8887-e94257e8a11b"
      },
      "name" : "Email Alert for Major/Critical Alarm",
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.filter.TbJsFilterNode"
    }, {
      "additionalInfo" : {
        "layoutX" : 1519,
        "layoutY" : 408
      },
      "configuration" : {
        "fromTemplate" : "support@log5data.com",
        "toTemplate" : "${tenantEmailNotify}",
        "ccTemplate" : null,
        "bccTemplate" : null,
        "subjectTemplate" : "Device ${label} ${alarmType} Alarm",
        "bodyTemplate" : "Log5Data reported a: ${alarmSeverity} ${alarmType} Alarm for ${label} at: ${alarmTime}. \n\n${label} reported ${measureName} ${measure} ${measureUnit}. \n\n${label} Thresholds Alarms are set as: \nMajor Threshold: ${majorThreshold} ${measureUnit}\nCritical Threshold: ${criticalThreshold} ${measureUnit}\n\n\nFor details go to: https://dcs.log5data.com"
      },
      "configurationVersion" : 0,
      "createdTime" : 0,
      "debugMode" : false,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "8e9463f0-3101-11eb-8887-e94257e8a11b"
      },
      "name" : "Alarm Created Email Notif",
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.mail.TbMsgToEmailNode"
    }, {
      "additionalInfo" : {
        "description" : null,
        "layoutX" : 1670,
        "layoutY" : 507
      },
      "configuration" : {
        "useSystemSmtpSettings" : true,
        "smtpHost" : "localhost",
        "smtpPort" : 25,
        "username" : null,
        "password" : null,
        "smtpProtocol" : "smtp",
        "timeout" : 10000,
        "enableTls" : false
      },
      "configurationVersion" : 0,
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "8e94d920-3101-11eb-8887-e94257e8a11b"
      },
      "name" : "send_an_email_alert",
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.mail.TbSendEmailNode"
    }, {
      "additionalInfo" : {
        "description" : null,
        "layoutX" : 1282,
        "layoutY" : 151
      },
      "configuration" : {
        "jsScript" : "var newMsg;\r\nvar d = new Date(msg.createdTime);\r\nmetadata.alarmTime = d.toLocaleString();\r\nif (msg.clearTs !== 0)\r\nmetadata.clearTime = new Date(msg.clearTs);\r\n\r\nif (msg.status == \"ACTIVE_UNACK\")\r\n    newMsg = msg.severity + ' Alarm: ' + msg.details.label + ' is reporting ' + msg.name + ' ' + metadata.measure + ' ' + metadata.measureUnit + ' ' + metadata.alarmTime + '.  For details goto: dcs.log5data.com';\r\nelse if (msg.status == \"CLEARED_UNACK\" || msg.status ==\r\n    'CLEARED_ACK')\r\n    newMsg = msg.severity + ' ' + msg.name + ' Alarm is cleared on ' +  msg.details.label + '.  ' + 'Current ' + metadata.measureName  + ' is ' + metadata.measure + 'C.  For details goto: dcs.log5data.com';\r\n\r\n\r\nreturn {\r\n    msg: newMsg,\r\n    metadata: metadata,\r\n    msgType: msgType\r\n};"
      },
      "configurationVersion" : 0,
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "8e952740-3101-11eb-8887-e94257e8a11b"
      },
      "name" : "Construct Mobile Notify",
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.transform.TbTransformMsgNode"
    }, {
      "additionalInfo" : {
        "description" : "Notify to mobile",
        "layoutX" : 1449,
        "layoutY" : 233
      },
      "configuration" : {
        "numbersTo" : "${tenantTextNotify}",
        "numberFrom" : "+14387963478",
        "accountSid" : "AC705ee3dc7460243ec1febeba7dd77bc5",
        "accountToken" : "0de7867636e4d705c4c6f6a58c476aef"
      },
      "configurationVersion" : 0,
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "8e959c70-3101-11eb-8887-e94257e8a11b"
      },
      "name" : "Log5Data Notification",
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.pe.twilio.TbTwilioSmsNode"
    }, {
      "additionalInfo" : {
        "layoutX" : 875,
        "layoutY" : 250
      },
      "configuration" : {
        "jsScript" : "return 'Incoming message:\\n' + JSON.stringify(msg) + '\\nIncoming metadata:\\n' + JSON.stringify(metadata);"
      },
      "configurationVersion" : 0,
      "createdTime" : 0,
      "debugMode" : false,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "8e95ea90-3101-11eb-8887-e94257e8a11b"
      },
      "name" : "Log Failure",
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.action.TbLogNode"
    }, {
      "additionalInfo" : {
        "layoutX" : 1330,
        "layoutY" : 554
      },
      "configuration" : {
        "fromTemplate" : "support@log5data.com",
        "toTemplate" : "${tenantEmailNotify}",
        "ccTemplate" : null,
        "bccTemplate" : null,
        "subjectTemplate" : "Device ${label} ${alarmType} Alarm Cleared",
        "bodyTemplate" : "${alarmSeverity} ${alarmType} alarm is cleared on ${label}.  \nCurrent ${measureName} is ${measure} ${measureUnit}. \nFor details go to: https://dcs.log5data.com"
      },
      "configurationVersion" : 0,
      "createdTime" : 0,
      "debugMode" : false,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "8e965fc0-3101-11eb-8887-e94257e8a11b"
      },
      "name" : "Alarm Cleared Email Notif",
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.mail.TbMsgToEmailNode"
    }, {
      "additionalInfo" : {
        "layoutX" : 1013,
        "layoutY" : 482
      },
      "configuration" : {
        "jsScript" : "return (msg.status === \"ACTIVE_UNACK\" || msg.status === \"ACTIVE_ACK\");\r\n\r\n"
      },
      "configurationVersion" : 0,
      "createdTime" : 0,
      "debugMode" : false,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "8e96ade0-3101-11eb-8887-e94257e8a11b"
      },
      "name" : "Alarm Created",
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.filter.TbJsFilterNode"
    }, {
      "additionalInfo" : {
        "layoutX" : 1248,
        "layoutY" : 408
      },
      "configuration" : {
        "jsScript" : "return msg.status === \"ACTIVE_UNACK\";"
      },
      "configurationVersion" : 0,
      "createdTime" : 0,
      "debugMode" : false,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "8e972310-3101-11eb-8887-e94257e8a11b"
      },
      "name" : "Active Alarm Unacknowledged",
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.filter.TbJsFilterNode"
    }, {
      "additionalInfo" : {
        "layoutX" : 937,
        "layoutY" : 356
      },
      "configuration" : {
        "jsScript" : "\nif (typeof metadata.ss_notifyThreshold !== 'undefined')\n    return msg.details.count >= metadata.ss_notifyThreshold;\nelse\n    return true;\n\n"
      },
      "configurationVersion" : 0,
      "createdTime" : 0,
      "debugMode" : false,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "8e977130-3101-11eb-8887-e94257e8a11b"
      },
      "name" : "Alarm Count Greater Equal to Alert Threshold",
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.filter.TbJsFilterNode"
    }, {
      "additionalInfo" : {
        "description" : null,
        "layoutX" : 585,
        "layoutY" : 150
      },
      "configuration" : {
        "jsScript" : "\nif (typeof metadata.ss_notifyThreshold !== 'undefined')\n    return msg.details.count >= metadata.ss_notifyThreshold;\nelse\n    return true;\n\n"
      },
      "configurationVersion" : 0,
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "8e97e660-3101-11eb-8887-e94257e8a11b"
      },
      "name" : "Alarm Count Greater Equal to Alert Threshold",
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.filter.TbJsFilterNode"
    }, {
      "additionalInfo" : {
        "description" : null,
        "layoutX" : 854,
        "layoutY" : 151
      },
      "configuration" : {
        "jsScript" : "return (msg.status === \"ACTIVE_UNACK\" || msg.status === \"ACTIVE_ACK\");\r\n\r\n"
      },
      "configurationVersion" : 0,
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "8e983480-3101-11eb-8887-e94257e8a11b"
      },
      "name" : "Alarm Created",
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.filter.TbJsFilterNode"
    }, {
      "additionalInfo" : {
        "description" : "HighPriority queue is really lower priority than main queue",
        "layoutX" : 87,
        "layoutY" : 231
      },
      "configuration" : {
        "queueName" : "HighPriority"
      },
      "configurationVersion" : 0,
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "8e9882a0-3101-11eb-8887-e94257e8a11b"
      },
      "name" : "Change to Low Priority Queue",
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.flow.TbCheckpointNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 217,
        "layoutY" : 537
      },
      "configuration" : {
        "jsScript" : "if (msg.severity == \"MAJOR\") \n    return metadata.ss_major_slack === 'true';\nelse if (msg.severity ==\"CRITICAL\")\n    return metadata.ss_critical_slack === 'true';\n"
      },
      "configurationVersion" : 0,
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "75d07520-3522-11ee-af84-a9f24bcd8f0a"
      },
      "name" : "Slack notify option",
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.filter.TbJsFilterNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 217,
        "layoutY" : 633
      },
      "configuration" : {
        "jsScript" : "return (msg.status === \"ACTIVE_UNACK\" || msg.status === \"ACTIVE_ACK\");\r\n"
      },
      "configurationVersion" : 0,
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "75d1ada0-3522-11ee-af84-a9f24bcd8f0a"
      },
      "name" : "Create Alarm",
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.filter.TbJsFilterNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 218,
        "layoutY" : 710
      },
      "configuration" : {
        "jsScript" : "if (msg.status == \"ACTIVE_UNACK\" && msg.details.count <= 1) {\n    return true;\n}else if (msg.status == \"ACTIVE_UNACK\" && msg.details.count > 1) {\n    return false;\n}"
      },
      "configurationVersion" : 0,
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "75d1fbc0-3522-11ee-af84-a9f24bcd8f0a"
      },
      "name" : "New Alarm unacknowledged",
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.filter.TbJsFilterNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 467,
        "layoutY" : 712
      },
      "configuration" : {
        "jsScript" : "var newMsg = {};\r\nvar emojie = '';\r\nvar emj = '';\r\nvar droplet = '\\uD83D\\uDCA7'; // üíß\r\nvar thermometer = '\\uD83C\\uDF21'; // üå°Ô∏è\r\nvar siren = '\\uD83D\\uDD14'; // üö®\r\nvar alert = '\\u26A0'; // ‚ö†Ô∏è\r\n\r\nif (metadata.measureName == 'Humidity') {\r\n    emojie = droplet; // Assign the appropriate emoji to the variable\r\n} else if (metadata.measureName == 'Temperature') {\r\n    emojie = thermometer; // Assign the appropriate emoji to the variable\r\n}\r\n\r\n\r\nif (msg.severity == \"MAJOR\") {\r\n    emj = siren; // Assign the appropriate emoji to the variable\r\n} else if (msg.severity == \"CRITICAL\") {\r\n    emj = alert; // Assign the appropriate emoji to the variable\r\n}\r\n\r\n\r\nif (msg.status == \"ACTIVE_UNACK\")\r\n    newMsg.text = emj + ' ' + msg.severity +  ' ' + emojie + ' ' + msg.name + '\\n'  + metadata.label + ' reports ' + metadata.measure + ' ' + metadata.measureUnit;\r\nelse if (msg.status == \"CLEARED_UNACK\" || msg.status ==\r\n    'CLEARED_ACK')\r\n    newMsg.text =   emj + ' ' + msg.severity  + ' ' + emojie + ' ' + msg.name + ' '  + 'Cleared ' + '\\n '   + metadata.label + ' reports ' + metadata.measure + ' ' + metadata.measureUnit;\r\n\r\nreturn {\r\n    msg: newMsg,\r\n    metadata: metadata,\r\n    msgType: msgType\r\n};"
      },
      "configurationVersion" : 0,
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "75d222d0-3522-11ee-af84-a9f24bcd8f0a"
      },
      "name" : "Construct Slack Notify",
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.transform.TbTransformMsgNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 219,
        "layoutY" : 800
      },
      "configuration" : {
        "jsScript" : "if (msg.details.statusChange == 1) {\n    return true; \n}else if (msg.details.statusChange == 0) {\n    return false;\n      }"
      },
      "configurationVersion" : 0,
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "75d270f0-3522-11ee-af84-a9f24bcd8f0a"
      },
      "name" : "Status Updated",
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.filter.TbJsFilterNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 464,
        "layoutY" : 802
      },
      "configuration" : {
        "jsScript" : "var newMsg = {};\r\nvar emojie = ''; \r\nvar emj = '';\r\nvar droplet = '\\uD83D\\uDCA7'; // üíß\r\nvar thermometer = '\\uD83C\\uDF21'; // üå°Ô∏è\r\nvar siren = '\\uD83D\\uDD14'; // üö®\r\nvar alert = '\\u26A0'; // ‚ö†Ô∏è\r\n\r\nif (metadata.measureName == 'Humidity') {\r\n    emojie = droplet; // Assign the appropriate emoji to the variable\r\n} else if (metadata.measureName == 'Temperature') {\r\n    emojie = thermometer; // Assign the appropriate emoji to the variable\r\n}\r\n\r\nif (msg.severity == \"MAJOR\") {\r\n    emj = siren; // Assign the appropriate emoji to the variable\r\n} else if (msg.severity == \"CRITICAL\") {\r\n    emj = alert; // Assign the appropriate emoji to the variable\r\n}\r\n\r\n\r\nif (msg.status == \"ACTIVE_UNACK\")\r\n    newMsg.text = emojie + ' ' + msg.name +  ' severity changed to ' + emj + ' ' + msg.severity + '\\n' + metadata.label + ' reports ' + metadata.measure + ' ' + metadata.measureUnit;\r\nelse if (msg.status == \"CLEARED_UNACK\" || msg.status ==\r\n    'CLEARED_ACK')\r\n    newMsg.text = emj + ' ' + msg.severity + ' ' + emojie + ' ' + msg.name + ' Cleared: ' + '\\n' + metadata.label + ' reports ' + metadata.measure + ' ' + metadata.measureUnit;\r\n\r\nreturn {\r\n    msg: newMsg,\r\n    metadata: metadata,\r\n    msgType: msgType\r\n};"
      },
      "configurationVersion" : 0,
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "75d29800-3522-11ee-af84-a9f24bcd8f0a"
      },
      "name" : "Construct Slack Notify",
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.transform.TbTransformMsgNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 718,
        "layoutY" : 753
      },
      "configuration" : {
        "restEndpointUrlPattern" : "${slackNotify} ",
        "requestMethod" : "POST",
        "useSimpleClientHttpFactory" : false,
        "enableProxy" : false,
        "useSystemProxyProperties" : false,
        "proxyScheme" : null,
        "proxyHost" : null,
        "proxyPort" : 0,
        "proxyUser" : null,
        "proxyPassword" : null,
        "readTimeoutMs" : 0,
        "maxParallelRequestsCount" : 0,
        "headers" : {
          "Content-Type" : "application/json"
        },
        "useRedisQueueForMsgPersistence" : false,
        "trimQueue" : false,
        "maxQueueSize" : 0,
        "credentials" : {
          "type" : "anonymous"
        }
      },
      "configurationVersion" : 1,
      "createdTime" : 0,
      "debugMode" : true,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "75d2e620-3522-11ee-af84-a9f24bcd8f0a"
      },
      "name" : "slack integration",
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.rest.TbRestApiCallNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 93,
        "layoutY" : 375,
        "ruleChainNodeId" : "rule-chain-node-25"
      },
      "configuration" : {
        "ruleChainId" : "84358100-6916-11ee-b451-6be2d47cc191"
      },
      "configurationVersion" : 0,
      "createdTime" : 0,
      "debugMode" : false,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "0b903430-b6e5-11ee-b88b-791a828c489c"
      },
      "name" : "Slack Notifier",
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.flow.TbRuleChainInputNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 318,
        "layoutY" : 427,
        "ruleChainNodeId" : "rule-chain-node-26"
      },
      "configuration" : {
        "ruleChainId" : "c58d26d0-c795-11ed-af84-a9f24bcd8f0a"
      },
      "configurationVersion" : 0,
      "createdTime" : 0,
      "debugMode" : false,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "0b9e8c10-b6e5-11ee-b88b-791a828c489c"
      },
      "name" : "Dragino Alarm Mode",
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.flow.TbRuleChainInputNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 318,
        "layoutY" : 427,
        "ruleChainNodeId" : "rule-chain-node-26"
      },
      "configuration" : {
        "ruleChainId" : "c58d26d0-c795-11ed-af84-a9f24bcd8f0a"
      },
      "configurationVersion" : 0,
      "createdTime" : 0,
      "debugMode" : false,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "0ba060d0-b6e5-11ee-b88b-791a828c489c"
      },
      "name" : "Dragino Alarm Mode",
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.flow.TbRuleChainInputNode"
    } ],
    "ruleChainConnections" : null
  },
  "relations" : [ ],
  "attributes" : {
    "SERVER_SCOPE" : [ ]
  }
}